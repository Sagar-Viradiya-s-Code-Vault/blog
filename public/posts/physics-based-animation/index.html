<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Android physics based animation | Sagar's Blog</title>
<meta name=keywords content="Animation,Physics based animation,Kotlin"><meta name=description content="May the force be with you"><meta name=author content><link rel=canonical href=https://sagarviradiya.dev/posts/physics-based-animation/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.083b73ab99f7bb76228f3b506c8b579236a3f308e4021b0c281be819e5d67681.css integrity="sha256-CDtzq5n3u3YijztQbItXkjaj8wjkAhsMKBvoGeXWdoE=" rel="preload stylesheet" as=style><link rel=icon href=https://sagarviradiya.dev/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://sagarviradiya.dev/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://sagarviradiya.dev/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://sagarviradiya.dev/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://sagarviradiya.dev/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://sagarviradiya.dev/posts/physics-based-animation/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://sagarviradiya.dev/posts/physics-based-animation/"><meta property="og:site_name" content="Sagar's Blog"><meta property="og:title" content="Android physics based animation"><meta property="og:description" content="May the force be with you"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-08-17T00:00:00+00:00"><meta property="article:modified_time" content="2017-08-17T00:00:00+00:00"><meta property="article:tag" content="Animation"><meta property="article:tag" content="Physics Based Animation"><meta property="article:tag" content="Kotlin"><meta property="og:image" content="https://sagarviradiya.dev/images/header.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sagarviradiya.dev/images/header.jpg"><meta name=twitter:title content="Android physics based animation"><meta name=twitter:description content="May the force be with you"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://sagarviradiya.dev/posts/"},{"@type":"ListItem","position":2,"name":"Android physics based animation","item":"https://sagarviradiya.dev/posts/physics-based-animation/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Android physics based animation","name":"Android physics based animation","description":"May the force be with you","keywords":["Animation","Physics based animation","Kotlin"],"articleBody":" May the mass * acceleration be with you\nAndroid has nice animation API. One can easily choreograph animation based on inbuilt interpolator or could implement own to get nice effect in animation. One thing that was missing till now was dynamic nature of animation just like how real life object behave when we apply force on it and in between if we perform some action on it how that force changes. Using Animator API we can animate object in smooth way. For example you can initially accelerate and decelerate object(and other such effects using interpolators). But animator API is static (once you start animation you can’t modify animation), has fix duration and there is no force associate with it. What if in middle of animation you want to change target of object ?. You can’t modify current animation. You have to cancel current one, create new animation and start it. Overall animation won’t be smooth and natural. There will be abrupt change in animation. So how do we make such transition smooth ?\nThis year at google IO, android team announced new animation API called Physics Based Animation. It is part of support library so that it is backward compatible till API 16. So let’s explore what is physics based animation and how it is different from normal animation.\nPhysics based animation vs. Non-Physics based animation If you want to create normal animation all you need is duration, start value, end value and interpolator. Animation is static and duration is fix. Velocity of animation is govern by duration of animation and interpolator. There is no external force involve here which is controlling progress of animation. Physics based animation is driven by force. Force you apply controls velocity of animation. Also you can modify target value of animation while animation is going on and physics based animation takes care of applying new force on existing velocity, which makes a continuous transition to the new target. To better understand difference between two look at the following figure.\nAs you can see in case of object animator(Left) there is abrupt change in animation if target value changes and physics based animation on the other hand is smooth. So far I have covered basics of physics based animation and how it is different from normal animation. Now it’s time to get your hand dirty and learn how to implement physics based animation.\nAndroid physics based animation API provides two types of animation.\nSpring Animation Animation of view property is driven by spring force. The properties of a spring, the value, and the velocity are used in creating a spring-based animation.\nFling Animation Animation of view property is driven by frictional force. Fling animation has an initial momentum and gradually slows down.\nLet’s explore both animation\nSpring Animation Spring animation is driven by spring force which depends on spring stiffness, damping ratio and object’s final position. It’s a same effect you get when you pull object tied to spring and release. Object bounce back and forth and finally comes to it’s initial position. Before diving into API it is important to understand properties of spring that determines spring force.\nStiffness measures the strength of the spring. In simple word you will require more force to pull object tied to spring which has high stiffness. Basically it tells how tight spring is.\nDamping ratio describes a gradual reduction in a spring oscillation. In simple word spring is more bouncy if it has damping ratio less than zero.\nIn a spring-based animation, the SpringForce class lets you customise spring’s stiffness, its damping ratio, and its final position. As soon as the animation begins, the spring force updates the animation value and the velocity on each frame. The animation continues until the spring force reaches an equilibrium.\nSpringAnimation class help you to create a spring animation for an object. Now let’s see how to achieve following animation.\nTo build a spring animation, you need to create an instance of the SpringAnimation class and provide an object, an object’s property that you want to animate, and an optional final spring position where you want the animation to rest.\nAt the time of creating a spring animation, the final position of the spring is optional. Though, it must be defined before starting the animation.\nprivate val springForce: SpringForce by lazy(LazyThreadSafetyMode.NONE) { SpringForce(0f).apply { stiffness = SpringForce.STIFFNESS_MEDIUM dampingRatio = SpringForce.DAMPING_RATIO_HIGH_BOUNCY } } private val springAnimationTranslationX: SpringAnimation by lazy(LazyThreadSafetyMode.NONE) { SpringAnimation(android_bot, DynamicAnimation.TRANSLATION_X).setSpring(springForce) } private val springAnimationTranslationY: SpringAnimation by lazy(LazyThreadSafetyMode.NONE) { SpringAnimation(android_bot, DynamicAnimation.TRANSLATION_Y).setSpring(springForce) } As you can see we have created spring animation instance for x and y translation of view android_bot(ImageView) and attached spring force with each instance. Now all we want is to implement touch listener on image so that we can move the image when we drag image. Finally when we release image we will start two spring animation on image(one for translationX and one for translationY).\nprivate fun setupTouchListener() { android_bot.setOnTouchListener { view, motionEvent -\u003e when(motionEvent?.action) { MotionEvent.ACTION_DOWN -\u003e { xDiffInTouchPointAndViewTopLeftCorner = motionEvent.rawX - view.x yDiffInTouchPointAndViewTopLeftCorner = motionEvent.rawY - view.y springAnimationTranslationX.cancel() springAnimationTranslationY.cancel() } MotionEvent.ACTION_MOVE -\u003e { android_bot.x = motionEvent.rawX - xDiffInTouchPointAndViewTopLeftCorner android_bot.y = motionEvent.rawY - yDiffInTouchPointAndViewTopLeftCorner } MotionEvent.ACTION_UP -\u003e { springAnimationTranslationX.start() springAnimationTranslationY.start() } } true } } That’s it, you done with spring animation!!!\nFling Animation Fling animation is driven by frictional force. If friction is high object will come to rest quickly and if it is low object will travel more. It has an initial momentum, which is mostly received from the gesture velocity, and gradually slows down.\nThe FlingAnimation class lets you create a fling animation for an object. To build a fling animation, create an instance of the FlingAnimation class and provide an object and the object’s property that you want to animate. Let’s see how to implement following animation.\nval flingAnimationX: FlingAnimation by lazy(LazyThreadSafetyMode.NONE) { FlingAnimation(android_bot, DynamicAnimation.X).setFriction(1.1f) } val flingAnimationY: FlingAnimation by lazy(LazyThreadSafetyMode.NONE) { FlingAnimation(android_bot, DynamicAnimation.Y).setFriction(1.1f) } Here we have created two instance of fling animation for animating x and y position of image. Friction for both animation is set to 1.1. Now whenever we perform fling gesture on image we want to animate our image in gesture direction. Let’s see code for that\nval gestureListener = object : GestureDetector.SimpleOnGestureListener() { override fun onDown(e: MotionEvent?): Boolean { return true } override fun onFling(e1: MotionEvent?, e2: MotionEvent?, velocityX: Float, velocityY: Float): Boolean { flingAnimationX.setStartVelocity(velocityX) flingAnimationY.setStartVelocity(velocityY) flingAnimationX.start() flingAnimationY.start() return true } } val gestureDetector = GestureDetector(context, gestureListener) android_bot.setOnTouchListener { _, motionEvent -\u003e gestureDetector.onTouchEvent(motionEvent) } Using SimpleOnGestureListener we can easily detect fling gesture on image. Callback to onFling method will give us fling gesture velocity in X and Y directions. We use these velocities to set start velocity of each fling animation and finally we start both animation. One thing to note here is we don’t want our animation to go beyond our screen size. To avoid that we need to set min and max value for each fling animation.\nandroid_bot.viewTreeObserver.addOnGlobalLayoutListener(object : ViewTreeObserver.OnGlobalLayoutListener { override fun onGlobalLayout() { flingAnimationX.setMinValue(0f).setMaxValue((screenSize.x - android_bot.width).toFloat()) flingAnimationY.setMinValue(0f).setMaxValue((screenSize.y - android_bot.height).toFloat()) android_bot.viewTreeObserver.removeOnGlobalLayoutListener(this) } }) Here min value for both animation is set to zero which is min value for x and y on screen. Max value for both animation is max value of x and y on screen minus image width and hight respectively.\nWoo hoo!!! We are done with both type of physics based animation. Next we will see how to achieve chain animation where one animation depends on other.\nChained Spring Animation Physics based animation API has two ways to start animation. First we already saw is using start() method. There is another way you can start animation and i.e using animateToFinalPosition() method. This method perform two tasks. First it will set the target value of animation and second it will start the animation, if it has not started. This will allow us to change the target value in middle of animation. In order to implement following chained spring animation this method will be helpful.\nSince animation of last image depends on second and animation of second image depends on first we have to change target value of both spring animation in between animation if target value of first image changes. For such an animation, it’s more convenient to use animateToFinalPosition() method. Let’s see how to implement chained spring animation.\nval firstSpringAnimationX by lazy(LazyThreadSafetyMode.NONE) { createSpringAnimation(android_bot1, DynamicAnimation.TRANSLATION_X) } val firstSpringAnimationY by lazy(LazyThreadSafetyMode.NONE) { createSpringAnimation(android_bot1, DynamicAnimation.TRANSLATION_Y) } val secondSpringAnimationX by lazy(LazyThreadSafetyMode.NONE) { createSpringAnimation(android_bot2, DynamicAnimation.TRANSLATION_X) } val secondSpringAnimationY by lazy(LazyThreadSafetyMode.NONE) { createSpringAnimation(android_bot2, DynamicAnimation.TRANSLATION_Y) } private fun \u003cK\u003e createSpringAnimation(view: K, property: FloatPropertyCompat\u003cK\u003e) : SpringAnimation { return SpringAnimation(view, property).setSpring(SpringForce()) } First we create spring animation for 2nd and 3rd image on translationX and translationY property. Next we have to implement translationX and translationY animation for first image so that when we drag it will move.\nprivate fun setupOnTouchListener() { ... android_bot.setOnTouchListener { view, motionEvent -\u003e if(motionEvent.action == MotionEvent.ACTION_MOVE) { val deltaX = motionEvent.rawX - lastX val deltaY = motionEvent.rawY - lastY view.translationX = deltaX + view.translationX view.translationY = deltaY + view.translationY firstSpringAnimationX.animateToFinalPosition(view.translationX) firstSpringAnimationY.animateToFinalPosition(view.translationY) } lastX = motionEvent.rawX lastY = motionEvent.rawY return@setOnTouchListener true } } As we animate first image, animation of second image begin immediately. And if second image’s animation is already going on change in target value will be applied and animation will be updated in next frame. Now finally we want third image to listen to change in animation of second image and update it’s animation.\nfirstSpringAnimationX.addUpdateListener { _, value, _ -\u003e secondSpringAnimationX.animateToFinalPosition(value) } firstSpringAnimationY.addUpdateListener { _, value, _ -\u003e secondSpringAnimationY.animateToFinalPosition(value) } TranslationX and translationY of second image also applied to third image and it will start animating third image.\nImagine implementing animation which is driven by force without physics based animation library. I am not saying it won’t be possible but it will be time consuming and difficult to maintain. Thanks to google and android team for such a good animation API. Having force controlling your animation makes it more natural.\nTo explore more about physics based animation watch following IO session.\nYou can find source code of sample app I have created to show physics based animation on github. And if you are kotlin fan like me good news for you is it is 100% written in kotlin.\nYou can find me on twitter, G+ and LinkedIn.\nThat’s it for now folks, Happy coding :)\nThis was originally posted on Medium\n","wordCount":"1718","inLanguage":"en","image":"https://sagarviradiya.dev/images/header.jpg","datePublished":"2017-08-17T00:00:00Z","dateModified":"2017-08-17T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://sagarviradiya.dev/posts/physics-based-animation/"},"publisher":{"@type":"Organization","name":"Sagar's Blog","logo":{"@type":"ImageObject","url":"https://sagarviradiya.dev/%3Clink%20/%20abs%20url%3E"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://sagarviradiya.dev/ accesskey=h title="Sagar Viradiya (Alt + H)"><img src=https://sagarviradiya.dev/apple-touch-icon.png alt aria-label=logo height=35>Sagar Viradiya</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://sagarviradiya.dev/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://sagarviradiya.dev/talks/ title=Talks><span>Talks</span></a></li><li><a href=https://sagarviradiya.dev/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://sagarviradiya.dev/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://sagarviradiya.dev/>Home</a>&nbsp;»&nbsp;<a href=https://sagarviradiya.dev/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Android physics based animation</h1><div class=post-meta><span title='2017-08-17 00:00:00 +0000 UTC'>August 17, 2017</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;1718 words</div></header><figure class=entry-cover><a href=https://sagarviradiya.dev/posts/physics-based-animation/images/header.jpg target=_blank rel="noopener noreferrer"><img loading=eager srcset="https://sagarviradiya.dev/posts/physics-based-animation/images/header_hu13326001020103329747.jpg 360w ,https://sagarviradiya.dev/posts/physics-based-animation/images/header_hu8880346188502627710.jpg 480w ,https://sagarviradiya.dev/posts/physics-based-animation/images/header_hu17907282781694761418.jpg 720w ,https://sagarviradiya.dev/posts/physics-based-animation/images/header_hu7367730171581392038.jpg 1080w ,https://sagarviradiya.dev/posts/physics-based-animation/images/header_hu3092786824265993828.jpg 1500w ,https://sagarviradiya.dev/posts/physics-based-animation/images/header.jpg 6214w" sizes="(min-width: 768px) 720px, 100vw" src=https://sagarviradiya.dev/posts/physics-based-animation/images/header.jpg alt="Photo by [Brian McGowan](https://unsplash.com/@sushioutlaw?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash) on [Unsplash](https://unsplash.com/photos/white-robot-toy-on-black-background-ggg_B1MeqQk?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash)" width=6214 height=4143></a><p>Photo by <a href="https://unsplash.com/@sushioutlaw?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Brian McGowan</a> on <a href="https://unsplash.com/photos/white-robot-toy-on-black-background-ggg_B1MeqQk?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash">Unsplash</a></p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#physics-based-animation-vs-non-physics-based-animation>Physics based animation vs. Non-Physics based animation</a><ul><li><a href=#spring-animation>Spring Animation</a></li><li><a href=#fling-animation>Fling Animation</a></li></ul></li><li><a href=#spring-animation-1>Spring Animation</a></li><li><a href=#fling-animation-1>Fling Animation</a></li><li><a href=#chained-spring-animation>Chained Spring Animation</a></li></ul></nav></div></details></div><div class=post-content><blockquote><p><em>May the mass * acceleration be with you</em></p></blockquote><p>Android has nice animation API. One can easily choreograph animation based on inbuilt interpolator or could implement own to get nice effect in animation. One thing that was missing till now was dynamic nature of animation just like how real life object behave when we apply force on it and in between if we perform some action on it how that force changes. Using <strong>Animator</strong> API we can animate object in smooth way. For example you can initially accelerate and decelerate object(and other such effects using interpolators). But animator API is static (once you start animation you can’t modify animation), has fix duration and there is no force associate with it. What if in middle of animation you want to change target of object ?. You can’t modify current animation. You have to cancel current one, create new animation and start it. Overall animation won’t be smooth and natural. There will be abrupt change in animation. So how do we make such transition smooth ?</p><iframe width=480 height=259 src=https://giphy.com/embed/xT9KVmZwJl7fnigeAg frameborder allowfullscreen></iframe><p>This year at google IO, android team announced new animation API called <a href=https://developer.android.com/topic/libraries/support-library/preview/physics-based-animation.html><strong>Physics Based Animation</strong></a>. It is part of support library so that it is backward compatible till API 16. So let’s explore what is physics based animation and how it is different from normal animation.</p><h2 id=physics-based-animation-vs-non-physics-based-animation>Physics based animation vs. Non-Physics based animation<a hidden class=anchor aria-hidden=true href=#physics-based-animation-vs-non-physics-based-animation>#</a></h2><p>If you want to create normal animation all you need is duration, start value, end value and interpolator. Animation is static and duration is fix. Velocity of animation is govern by duration of animation and interpolator. There is no external force involve here which is controlling progress of animation. Physics based animation is driven by force. Force you apply controls velocity of animation. Also you can modify target value of animation while animation is going on and physics based animation takes care of applying new force on existing velocity, which makes a continuous transition to the new target. To better understand difference between two look at the following figure.</p><iframe width=700 height=500 src=images/physics-based-animation.gif frameborder allowfullscreen></iframe><p>As you can see in case of object animator(Left) there is abrupt change in animation if target value changes and physics based animation on the other hand is smooth. So far I have covered basics of physics based animation and how it is different from normal animation. Now it’s time to get your hand dirty and learn how to implement physics based animation.</p><iframe width=480 height=288 src=https://giphy.com/embed/13GIgrGdslD9oQ frameborder allowfullscreen></iframe><p>Android physics based animation API provides two types of animation.</p><h3 id=spring-animation>Spring Animation<a hidden class=anchor aria-hidden=true href=#spring-animation>#</a></h3><p>Animation of view property is driven by spring force. The properties of a spring, the value, and the velocity are used in creating a spring-based animation.</p><h3 id=fling-animation>Fling Animation<a hidden class=anchor aria-hidden=true href=#fling-animation>#</a></h3><p>Animation of view property is driven by frictional force. Fling animation has an initial momentum and gradually slows down.</p><p>Let’s explore both animation</p><h2 id=spring-animation-1>Spring Animation<a hidden class=anchor aria-hidden=true href=#spring-animation-1>#</a></h2><p>Spring animation is driven by spring force which depends on spring <em>stiffness, damping ratio and object’s final position</em>. It’s a same effect you get when you pull object tied to spring and release. Object bounce back and forth and finally comes to it’s initial position. Before diving into API it is important to understand properties of spring that determines spring force.</p><p><strong>Stiffness</strong> measures the strength of the spring. In simple word you will require more force to pull object tied to spring which has high stiffness. Basically it tells how tight spring is.</p><p><strong>Damping ratio</strong> describes a gradual reduction in a spring oscillation. In simple word spring is more bouncy if it has damping ratio less than zero.</p><p>In a spring-based animation, the SpringForce class lets you customise spring&rsquo;s stiffness, its damping ratio, and its final position. As soon as the animation begins, the spring force updates the animation value and the velocity on each frame. The animation continues until the spring force reaches an equilibrium.</p><p><a href=https://developer.android.com/reference/android/support/animation/SpringAnimation.html><code>SpringAnimation</code></a> class help you to create a spring animation for an object. Now let’s see how to achieve following animation.</p><iframe width=480 height=640 src=images/spring_animation.gif frameborder allowfullscreen></iframe><p>To build a spring animation, you need to create an instance of the <a href=https://developer.android.com/reference/android/support/animation/SpringAnimation.html><code>SpringAnimation</code></a> class and provide an object, an object’s property that you want to animate, and an optional final spring position where you want the animation to rest.</p><blockquote><p><em>At the time of creating a spring animation, the final position of the spring is optional. Though, it must be defined before starting the animation.</em></p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>private</span> <span class=k>val</span> <span class=py>springForce</span><span class=p>:</span> <span class=n>SpringForce</span> <span class=k>by</span> <span class=n>lazy</span><span class=p>(</span><span class=nc>LazyThreadSafetyMode</span><span class=p>.</span><span class=n>NONE</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>SpringForce</span><span class=p>(</span><span class=m>0f</span><span class=p>).</span><span class=n>apply</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>stiffness</span> <span class=p>=</span> <span class=nc>SpringForce</span><span class=p>.</span><span class=n>STIFFNESS_MEDIUM</span>
</span></span><span class=line><span class=cl>        <span class=n>dampingRatio</span> <span class=p>=</span> <span class=nc>SpringForce</span><span class=p>.</span><span class=n>DAMPING_RATIO_HIGH_BOUNCY</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>private</span> <span class=k>val</span> <span class=py>springAnimationTranslationX</span><span class=p>:</span> <span class=n>SpringAnimation</span> <span class=k>by</span> <span class=n>lazy</span><span class=p>(</span><span class=nc>LazyThreadSafetyMode</span><span class=p>.</span><span class=n>NONE</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>SpringAnimation</span><span class=p>(</span><span class=n>android_bot</span><span class=p>,</span> <span class=nc>DynamicAnimation</span><span class=p>.</span><span class=n>TRANSLATION_X</span><span class=p>).</span><span class=n>setSpring</span><span class=p>(</span><span class=n>springForce</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>private</span> <span class=k>val</span> <span class=py>springAnimationTranslationY</span><span class=p>:</span> <span class=n>SpringAnimation</span> <span class=k>by</span> <span class=n>lazy</span><span class=p>(</span><span class=nc>LazyThreadSafetyMode</span><span class=p>.</span><span class=n>NONE</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>SpringAnimation</span><span class=p>(</span><span class=n>android_bot</span><span class=p>,</span> <span class=nc>DynamicAnimation</span><span class=p>.</span><span class=n>TRANSLATION_Y</span><span class=p>).</span><span class=n>setSpring</span><span class=p>(</span><span class=n>springForce</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>As you can see we have created spring animation instance for x and y translation of view android_bot(ImageView) and attached spring force with each instance. Now all we want is to implement touch listener on image so that we can move the image when we drag image. Finally when we release image we will start two spring animation on image(one for translationX and one for translationY).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>private</span> <span class=k>fun</span> <span class=nf>setupTouchListener</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>android_bot</span><span class=p>.</span><span class=n>setOnTouchListener</span> <span class=p>{</span> <span class=n>view</span><span class=p>,</span> <span class=n>motionEvent</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>when</span><span class=p>(</span><span class=n>motionEvent</span><span class=o>?.</span><span class=n>action</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nc>MotionEvent</span><span class=p>.</span><span class=n>ACTION_DOWN</span> <span class=o>-&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>xDiffInTouchPointAndViewTopLeftCorner</span> <span class=p>=</span> <span class=n>motionEvent</span><span class=p>.</span><span class=n>rawX</span> <span class=p>-</span> <span class=n>view</span><span class=p>.</span><span class=n>x</span>
</span></span><span class=line><span class=cl>                <span class=n>yDiffInTouchPointAndViewTopLeftCorner</span> <span class=p>=</span> <span class=n>motionEvent</span><span class=p>.</span><span class=n>rawY</span> <span class=p>-</span> <span class=n>view</span><span class=p>.</span><span class=n>y</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=n>springAnimationTranslationX</span><span class=p>.</span><span class=n>cancel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=n>springAnimationTranslationY</span><span class=p>.</span><span class=n>cancel</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nc>MotionEvent</span><span class=p>.</span><span class=n>ACTION_MOVE</span> <span class=o>-&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>android_bot</span><span class=p>.</span><span class=n>x</span> <span class=p>=</span> <span class=n>motionEvent</span><span class=p>.</span><span class=n>rawX</span> <span class=p>-</span> <span class=n>xDiffInTouchPointAndViewTopLeftCorner</span>
</span></span><span class=line><span class=cl>                <span class=n>android_bot</span><span class=p>.</span><span class=n>y</span> <span class=p>=</span> <span class=n>motionEvent</span><span class=p>.</span><span class=n>rawY</span> <span class=p>-</span> <span class=n>yDiffInTouchPointAndViewTopLeftCorner</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=nc>MotionEvent</span><span class=p>.</span><span class=n>ACTION_UP</span> <span class=o>-&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>springAnimationTranslationX</span><span class=p>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                <span class=n>springAnimationTranslationY</span><span class=p>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>true</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>That’s it, you done with spring animation!!!</p><h2 id=fling-animation-1>Fling Animation<a hidden class=anchor aria-hidden=true href=#fling-animation-1>#</a></h2><p>Fling animation is driven by frictional force. If friction is high object will come to rest quickly and if it is low object will travel more. It has an initial momentum, which is mostly received from the gesture velocity, and gradually slows down.</p><p>The <a href=https://developer.android.com/reference/android/support/animation/FlingAnimation.html><code>FlingAnimation</code></a> class lets you create a fling animation for an object. To build a fling animation, create an instance of the <a href=https://developer.android.com/reference/android/support/animation/FlingAnimation.html><code>FlingAnimation</code></a> class and provide an object and the object&rsquo;s property that you want to animate. Let’s see how to implement following animation.</p><iframe width=480 height=640 src=images/fling_animation.gif frameborder allowfullscreen></iframe><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>val</span> <span class=py>flingAnimationX</span><span class=p>:</span> <span class=n>FlingAnimation</span> <span class=k>by</span> <span class=n>lazy</span><span class=p>(</span><span class=nc>LazyThreadSafetyMode</span><span class=p>.</span><span class=n>NONE</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>FlingAnimation</span><span class=p>(</span><span class=n>android_bot</span><span class=p>,</span> <span class=nc>DynamicAnimation</span><span class=p>.</span><span class=n>X</span><span class=p>).</span><span class=n>setFriction</span><span class=p>(</span><span class=m>1.1f</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>val</span> <span class=py>flingAnimationY</span><span class=p>:</span> <span class=n>FlingAnimation</span> <span class=k>by</span> <span class=n>lazy</span><span class=p>(</span><span class=nc>LazyThreadSafetyMode</span><span class=p>.</span><span class=n>NONE</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>FlingAnimation</span><span class=p>(</span><span class=n>android_bot</span><span class=p>,</span> <span class=nc>DynamicAnimation</span><span class=p>.</span><span class=n>Y</span><span class=p>).</span><span class=n>setFriction</span><span class=p>(</span><span class=m>1.1f</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Here we have created two instance of fling animation for animating x and y position of image. Friction for both animation is set to 1.1. Now whenever we perform fling gesture on image we want to animate our image in gesture direction. Let’s see code for that</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>val</span> <span class=py>gestureListener</span> <span class=p>=</span> <span class=k>object</span> <span class=err>: </span><span class=nc>GestureDetector</span><span class=p>.</span><span class=n>SimpleOnGestureListener</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>onDown</span><span class=p>(</span><span class=n>e</span><span class=p>:</span> <span class=n>MotionEvent</span><span class=p>?):</span> <span class=n>Boolean</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>true</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>onFling</span><span class=p>(</span><span class=n>e1</span><span class=p>:</span> <span class=n>MotionEvent</span><span class=p>?,</span> <span class=n>e2</span><span class=p>:</span> <span class=n>MotionEvent</span><span class=p>?,</span> <span class=n>velocityX</span><span class=p>:</span> <span class=n>Float</span><span class=p>,</span> <span class=n>velocityY</span><span class=p>:</span> <span class=n>Float</span><span class=p>):</span> <span class=n>Boolean</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>flingAnimationX</span><span class=p>.</span><span class=n>setStartVelocity</span><span class=p>(</span><span class=n>velocityX</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>flingAnimationY</span><span class=p>.</span><span class=n>setStartVelocity</span><span class=p>(</span><span class=n>velocityY</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>flingAnimationX</span><span class=p>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>flingAnimationY</span><span class=p>.</span><span class=n>start</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>true</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>val</span> <span class=py>gestureDetector</span> <span class=p>=</span> <span class=n>GestureDetector</span><span class=p>(</span><span class=n>context</span><span class=p>,</span> <span class=n>gestureListener</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>android_bot</span><span class=p>.</span><span class=n>setOnTouchListener</span> <span class=p>{</span> <span class=n>_</span><span class=p>,</span> <span class=n>motionEvent</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>    <span class=n>gestureDetector</span><span class=p>.</span><span class=n>onTouchEvent</span><span class=p>(</span><span class=n>motionEvent</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Using SimpleOnGestureListener we can easily detect fling gesture on image. Callback to onFling method will give us fling gesture velocity in X and Y directions. We use these velocities to set start velocity of each fling animation and finally we start both animation. One thing to note here is we don’t want our animation to go beyond our screen size. To avoid that we need to set min and max value for each fling animation.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=n>android_bot</span><span class=p>.</span><span class=n>viewTreeObserver</span><span class=p>.</span><span class=n>addOnGlobalLayoutListener</span><span class=p>(</span><span class=k>object</span> <span class=err>: </span><span class=nc>ViewTreeObserver</span><span class=p>.</span><span class=n>OnGlobalLayoutListener</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>override</span> <span class=k>fun</span> <span class=nf>onGlobalLayout</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>flingAnimationX</span><span class=p>.</span><span class=n>setMinValue</span><span class=p>(</span><span class=m>0f</span><span class=p>).</span><span class=n>setMaxValue</span><span class=p>((</span><span class=n>screenSize</span><span class=p>.</span><span class=n>x</span> <span class=p>-</span> <span class=n>android_bot</span><span class=p>.</span><span class=n>width</span><span class=p>).</span><span class=n>toFloat</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=n>flingAnimationY</span><span class=p>.</span><span class=n>setMinValue</span><span class=p>(</span><span class=m>0f</span><span class=p>).</span><span class=n>setMaxValue</span><span class=p>((</span><span class=n>screenSize</span><span class=p>.</span><span class=n>y</span> <span class=p>-</span> <span class=n>android_bot</span><span class=p>.</span><span class=n>height</span><span class=p>).</span><span class=n>toFloat</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=n>android_bot</span><span class=p>.</span><span class=n>viewTreeObserver</span><span class=p>.</span><span class=n>removeOnGlobalLayoutListener</span><span class=p>(</span><span class=k>this</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>Here min value for both animation is set to zero which is min value for x and y on screen. Max value for both animation is max value of x and y on screen minus image width and hight respectively.</p><p>Woo hoo!!! We are done with both type of physics based animation. Next we will see how to achieve chain animation where one animation depends on other.</p><h2 id=chained-spring-animation>Chained Spring Animation<a hidden class=anchor aria-hidden=true href=#chained-spring-animation>#</a></h2><p>Physics based animation API has two ways to start animation. First we already saw is using <em><code>start()</code></em> method. There is another way you can start animation and i.e using <em><code>animateToFinalPosition()</code></em> method. This method perform two tasks. First it will set the target value of animation and second it will start the animation, if it has not started. This will allow us to change the target value in middle of animation. In order to implement following chained spring animation this method will be helpful.</p><iframe width=480 height=640 src=images/chained_spring_animation.gif frameborder allowfullscreen></iframe><p>Since animation of last image depends on second and animation of second image depends on first we have to change target value of both spring animation in between animation if target value of first image changes. For such an animation, it’s more convenient to use <em><code>animateToFinalPosition()</code></em> method. Let’s see how to implement chained spring animation.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>val</span> <span class=py>firstSpringAnimationX</span> <span class=k>by</span> <span class=n>lazy</span><span class=p>(</span><span class=nc>LazyThreadSafetyMode</span><span class=p>.</span><span class=n>NONE</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>createSpringAnimation</span><span class=p>(</span><span class=n>android_bot1</span><span class=p>,</span> <span class=nc>DynamicAnimation</span><span class=p>.</span><span class=n>TRANSLATION_X</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>val</span> <span class=py>firstSpringAnimationY</span> <span class=k>by</span> <span class=n>lazy</span><span class=p>(</span><span class=nc>LazyThreadSafetyMode</span><span class=p>.</span><span class=n>NONE</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>createSpringAnimation</span><span class=p>(</span><span class=n>android_bot1</span><span class=p>,</span> <span class=nc>DynamicAnimation</span><span class=p>.</span><span class=n>TRANSLATION_Y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>val</span> <span class=py>secondSpringAnimationX</span> <span class=k>by</span> <span class=n>lazy</span><span class=p>(</span><span class=nc>LazyThreadSafetyMode</span><span class=p>.</span><span class=n>NONE</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>createSpringAnimation</span><span class=p>(</span><span class=n>android_bot2</span><span class=p>,</span> <span class=nc>DynamicAnimation</span><span class=p>.</span><span class=n>TRANSLATION_X</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>val</span> <span class=py>secondSpringAnimationY</span> <span class=k>by</span> <span class=n>lazy</span><span class=p>(</span><span class=nc>LazyThreadSafetyMode</span><span class=p>.</span><span class=n>NONE</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>createSpringAnimation</span><span class=p>(</span><span class=n>android_bot2</span><span class=p>,</span> <span class=nc>DynamicAnimation</span><span class=p>.</span><span class=n>TRANSLATION_Y</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>private</span> <span class=k>fun</span> <span class=p>&lt;</span><span class=nc>K</span><span class=p>&gt;</span> <span class=nf>createSpringAnimation</span><span class=p>(</span><span class=n>view</span><span class=p>:</span> <span class=n>K</span><span class=p>,</span> <span class=k>property</span><span class=p>:</span> <span class=n>FloatPropertyCompat</span><span class=p>&lt;</span><span class=n>K</span><span class=p>&gt;)</span> <span class=p>:</span> <span class=n>SpringAnimation</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>SpringAnimation</span><span class=p>(</span><span class=n>view</span><span class=p>,</span> <span class=k>property</span><span class=p>).</span><span class=n>setSpring</span><span class=p>(</span><span class=n>SpringForce</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>First we create spring animation for 2nd and 3rd image on translationX and translationY property. Next we have to implement translationX and translationY animation for first image so that when we drag it will move.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=k>private</span> <span class=k>fun</span> <span class=nf>setupOnTouchListener</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=o>..</span><span class=p>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>android_bot</span><span class=p>.</span><span class=n>setOnTouchListener</span> <span class=p>{</span> <span class=n>view</span><span class=p>,</span> <span class=n>motionEvent</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(</span><span class=n>motionEvent</span><span class=p>.</span><span class=n>action</span> <span class=o>==</span> <span class=nc>MotionEvent</span><span class=p>.</span><span class=n>ACTION_MOVE</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>val</span> <span class=py>deltaX</span> <span class=p>=</span> <span class=n>motionEvent</span><span class=p>.</span><span class=n>rawX</span> <span class=p>-</span> <span class=n>lastX</span>
</span></span><span class=line><span class=cl>            <span class=k>val</span> <span class=py>deltaY</span> <span class=p>=</span> <span class=n>motionEvent</span><span class=p>.</span><span class=n>rawY</span> <span class=p>-</span> <span class=n>lastY</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>view</span><span class=p>.</span><span class=n>translationX</span> <span class=p>=</span> <span class=n>deltaX</span> <span class=p>+</span> <span class=n>view</span><span class=p>.</span><span class=n>translationX</span>
</span></span><span class=line><span class=cl>            <span class=n>view</span><span class=p>.</span><span class=n>translationY</span> <span class=p>=</span> <span class=n>deltaY</span> <span class=p>+</span> <span class=n>view</span><span class=p>.</span><span class=n>translationY</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>firstSpringAnimationX</span><span class=p>.</span><span class=n>animateToFinalPosition</span><span class=p>(</span><span class=n>view</span><span class=p>.</span><span class=n>translationX</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>firstSpringAnimationY</span><span class=p>.</span><span class=n>animateToFinalPosition</span><span class=p>(</span><span class=n>view</span><span class=p>.</span><span class=n>translationY</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>lastX</span> <span class=p>=</span> <span class=n>motionEvent</span><span class=p>.</span><span class=n>rawX</span>
</span></span><span class=line><span class=cl>        <span class=n>lastY</span> <span class=p>=</span> <span class=n>motionEvent</span><span class=p>.</span><span class=n>rawY</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=nd>@setOnTouchListener</span> <span class=k>true</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>As we animate first image, animation of second image begin immediately. And if second image’s animation is already going on change in target value will be applied and animation will be updated in next frame. Now finally we want third image to listen to change in animation of second image and update it’s animation.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-kotlin data-lang=kotlin><span class=line><span class=cl><span class=n>firstSpringAnimationX</span><span class=p>.</span><span class=n>addUpdateListener</span> <span class=p>{</span> <span class=n>_</span><span class=p>,</span> <span class=k>value</span><span class=p>,</span> <span class=n>_</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>    <span class=n>secondSpringAnimationX</span><span class=p>.</span><span class=n>animateToFinalPosition</span><span class=p>(</span><span class=k>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>firstSpringAnimationY</span><span class=p>.</span><span class=n>addUpdateListener</span> <span class=p>{</span> <span class=n>_</span><span class=p>,</span> <span class=k>value</span><span class=p>,</span> <span class=n>_</span> <span class=o>-&gt;</span>
</span></span><span class=line><span class=cl>    <span class=n>secondSpringAnimationY</span><span class=p>.</span><span class=n>animateToFinalPosition</span><span class=p>(</span><span class=k>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>TranslationX and translationY of second image also applied to third image and it will start animating third image.</p><p>Imagine implementing animation which is driven by force without physics based animation library. I am not saying it won’t be possible but it will be time consuming and difficult to maintain. Thanks to google and android team for such a good animation API. Having force controlling your animation makes it more natural.</p><p>To explore more about physics based animation watch following IO session.</p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen loading=eager referrerpolicy=strict-origin-when-cross-origin src="https://www.youtube.com/embed/BNcODK-Ju0g?autoplay=0&controls=1&end=0&loop=0&mute=0&start=0" style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 title="YouTube video"></iframe></div><p>You can find source code of sample app I have created to show physics based animation on <a href=https://github.com/sagar-viradiya/AndroidPhysicsAnimation>github</a>. And if you are kotlin fan like me good news for you is it is 100% written in kotlin.</p><p>You can find me on <a href=https://twitter.com/viradiya_sagar><strong>twitter</strong></a>, <a href=https://plus.google.com/u/1/+SagarViradiya_Profile><strong>G+</strong></a> and <a href=https://www.linkedin.com/in/sagarviradiya/><strong>LinkedIn</strong></a>.</p><p>That’s it for now folks, Happy coding :)</p><blockquote><p><em>This was originally posted on <a href=https://medium.com/android-news/android-physics-based-animation-cf0cc125830f>Medium</a></em></p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://sagarviradiya.dev/tags/animation/>Animation</a></li><li><a href=https://sagarviradiya.dev/tags/physics-based-animation/>Physics Based Animation</a></li><li><a href=https://sagarviradiya.dev/tags/kotlin/>Kotlin</a></li></ul><nav class=paginav><a class=prev href=https://sagarviradiya.dev/posts/getting-started-with-kotlin/><span class=title>« Prev</span><br><span>Getting started with kotlin</span></a></nav></footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//sagarviradiya-dev.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2025 <a href=https://sagarviradiya.dev/>Sagar's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>