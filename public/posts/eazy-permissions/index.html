<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Eazy permissions | Sagar's Blog</title>
<meta name=keywords content="Runtime Permissions,Kotlin,Kotlin Coroutines,LiveData,Android"><meta name=description content="An introduction to the runtime permission library."><meta name=author content><link rel=canonical href=https://sagarviradiya.dev/posts/eazy-permissions/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.083b73ab99f7bb76228f3b506c8b579236a3f308e4021b0c281be819e5d67681.css integrity="sha256-CDtzq5n3u3YijztQbItXkjaj8wjkAhsMKBvoGeXWdoE=" rel="preload stylesheet" as=style><link rel=icon href=https://sagarviradiya.dev/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://sagarviradiya.dev/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://sagarviradiya.dev/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://sagarviradiya.dev/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://sagarviradiya.dev/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://sagarviradiya.dev/posts/eazy-permissions/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://sagarviradiya.dev/posts/eazy-permissions/"><meta property="og:site_name" content="Sagar's Blog"><meta property="og:title" content="Eazy permissions"><meta property="og:description" content="An introduction to the runtime permission library."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-06-17T00:00:00+00:00"><meta property="article:modified_time" content="2019-06-17T00:00:00+00:00"><meta property="article:tag" content="Runtime Permissions"><meta property="article:tag" content="Kotlin"><meta property="article:tag" content="Kotlin Coroutines"><meta property="article:tag" content="LiveData"><meta property="article:tag" content="Android"><meta property="og:image" content="https://sagarviradiya.dev/images/header.webp"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sagarviradiya.dev/images/header.webp"><meta name=twitter:title content="Eazy permissions"><meta name=twitter:description content="An introduction to the runtime permission library."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://sagarviradiya.dev/posts/"},{"@type":"ListItem","position":2,"name":"Eazy permissions","item":"https://sagarviradiya.dev/posts/eazy-permissions/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Eazy permissions","name":"Eazy permissions","description":"An introduction to the runtime permission library.","keywords":["Runtime Permissions","Kotlin","Kotlin Coroutines","LiveData","Android"],"articleBody":"Hey folks, good to see you back after a long time ðŸ‘‹. I have been working on the Android library called eazypermissions for past one month which allows you to request runtime permission with coroutines and LiveData support. In this post, we will see why I created this library and a basic introduction to the library.\nThe motto ðŸŽ¯ In this yearâ€™s Google I/O there were lots of announcements regarding coroutines support for Jetpack libraries. Also since coroutines became stable in Kotlin 1.3.0 there were also lots of buzz about it in community.\nThe community is slowly adapting coroutines and itâ€™s here to stay for sure. The fact that you can write asynchronous code in a sequential way makes your code clean and concise.\nOftentimes we consume the third party library APIs in our coroutines and those APIs were not designed having coroutines in mind. But things are changing and some popular third-party libraries are started supporting coroutines e.g. Retrofit 2.6.0 now has suspend support.\nRuntime permission is callback based API wherein you request for permission and listen for the result. Wouldnâ€™t it be awesome if you donâ€™t need to write boilerplate callback code for the result and consume it in a sequential way within coroutines? Well, this is exactly why I wrote this library focusing on clean and concise API that you can easily consume within coroutines (No callbacks yay ðŸŽ‰). We will see how in a bit.\nComing to LiveData support, Architecture Components has been around for quite some time. Observing runtime permission results through LiveData could be one of the interesting use-case. I thought it would be nice to have runtime permission API around LiveData. The library will expose LiveData of result and consumer can observe and decide what to do upon the result. We will see how in a bit.\nIntroduction to Eazy Permissions Based on your need (coroutines support or LiveData support) you can include the library in your project as shown below.\n//For coroutines implementation 'com.sagar:coroutinespermission:1.0.0' //For LiveData implementation 'com.sagar:livedatapermission:1.0.0' Coroutines support Requesting permission is just a simple function call to suspending function requestPermissions of PermissionManager from your coroutines or other suspending function which will return PermissionResult. It takes 3 parameters.\nAn instance of AppCompactActivity or Fragment depending on from where you are requesting permission. Request id. varargs of permission you want to request. Here is the signature of requestPermissions method.\nThis is how you would request for permission within coroutines and get result sequentially.\nYou can request permission from coroutines launched using any dispatcher (IO/Default/Main).\nLibrary exposes PermissionResult as a result of permission request which is nothing but simple sealed class which wraps all possible outcomes.\nLiveData support Just in case of coroutines we saw above requesting permission is just a simple method call to PermissionManager from your Activity/Fragment. It takes 3 parameters.\nAn instance of AppCompactActivity or Fragment depending from where you are requesting permission. Request id. varargs of permission you want to request. Here is the signature of requestPermissions method.\nThis is how you would request permissions from your Activity/Fragment.\nObserving result With just one simple step (implementing an interface) you are ready to observe the result of the request. Your Activity/Fragment must implement **setupObserver** method of PermissionObserver interface which exposes LiveData\u003cPermissionResult\u003e. Here is the definition of interface.\nThe library will only call setupObserver method when you are requesting permission for the first time. All the successive call to requestPermissions method will use the same observer.\nJust as you would observe other LiveData you can observe LiveData\u003cPermissionResult\u003e as shown below.\nThatâ€™s it, thatâ€™s all I had to share with you folks about this library. I will be maintaining this library regularly and I am hoping for your suggestions and contributions to improve this library. Head over to the GitHub repo below for more details about library.\nEazy permission\nDo give it a shot and let me know your feedback in comments below or you can reach out to me on Twitter.\nThatâ€™s it, for now, folks ðŸ™‚ Until next time ðŸ‘‹\nHappy coding ðŸ˜ƒ\nThanks, Nate Ebel and Nemi Shah for proofreading this.\nThis was originally posted on Medium\n","wordCount":"688","inLanguage":"en","image":"https://sagarviradiya.dev/images/header.webp","datePublished":"2019-06-17T00:00:00Z","dateModified":"2019-06-17T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://sagarviradiya.dev/posts/eazy-permissions/"},"publisher":{"@type":"Organization","name":"Sagar's Blog","logo":{"@type":"ImageObject","url":"https://sagarviradiya.dev/%3Clink%20/%20abs%20url%3E"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://sagarviradiya.dev/ accesskey=h title="Sagar Viradiya (Alt + H)"><img src=https://sagarviradiya.dev/apple-touch-icon.png alt aria-label=logo height=35>Sagar Viradiya</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://sagarviradiya.dev/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://sagarviradiya.dev/talks/ title=Talks><span>Talks</span></a></li><li><a href=https://sagarviradiya.dev/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://sagarviradiya.dev/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://sagarviradiya.dev/>Home</a>&nbsp;Â»&nbsp;<a href=https://sagarviradiya.dev/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Eazy permissions</h1><div class=post-meta><span title='2019-06-17 00:00:00 +0000 UTC'>June 17, 2019</span>&nbsp;Â·&nbsp;4 min&nbsp;Â·&nbsp;688 words</div></header><figure class=entry-cover><a href=https://sagarviradiya.dev/posts/eazy-permissions/images/header.webp target=_blank rel="noopener noreferrer"><img loading=eager srcset="https://sagarviradiya.dev/posts/eazy-permissions/images/header_hu15418099744794425929.webp 360w ,https://sagarviradiya.dev/posts/eazy-permissions/images/header_hu5719415825958911295.webp 480w ,https://sagarviradiya.dev/posts/eazy-permissions/images/header_hu8987102859168207396.webp 720w ,https://sagarviradiya.dev/posts/eazy-permissions/images/header_hu7659350152795517995.webp 1080w ,https://sagarviradiya.dev/posts/eazy-permissions/images/header_hu4518464402588833628.webp 1500w ,https://sagarviradiya.dev/posts/eazy-permissions/images/header.webp 4032w" sizes="(min-width: 768px) 720px, 100vw" src=https://sagarviradiya.dev/posts/eazy-permissions/images/header.webp alt="Shot on my Pixel 3a XL" width=4032 height=3024></a><p>Shot on my Pixel 3a XL</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#the-motto->The motto ðŸŽ¯</a></li><li><a href=#introduction-to-eazy-permissions>Introduction to Eazy Permissions</a><ul><li><a href=#coroutines-support>Coroutines support</a></li><li><a href=#livedata-support>LiveData support</a></li></ul></li></ul></nav></div></details></div><div class=post-content><p>Hey folks, good to see you back after a long time ðŸ‘‹. I have been working on the Android library called <a href=https://github.com/sagar-viradiya/eazypermissions><code>eazypermissions</code></a> for past one month which allows you to request runtime permission with coroutines and LiveData support. In this post, we will see why I created this library and a basic introduction to the library.</p><h2 id=the-motto->The motto ðŸŽ¯<a hidden class=anchor aria-hidden=true href=#the-motto->#</a></h2><p>In this yearâ€™s Google I/O there were lots of announcements regarding coroutines support for Jetpack libraries. Also since coroutines became stable in <a href=https://blog.jetbrains.com/kotlin/2018/10/kotlin-1-3/>Kotlin 1.3.0</a> there were also lots of buzz about it in community.</p><p>The community is slowly adapting coroutines and it&rsquo;s here to stay for sure. The fact that you can write asynchronous code in a sequential way makes your code clean and concise.</p><p>Oftentimes we consume the third party library APIs in our coroutines and those APIs were not designed having coroutines in mind. But things are changing and some popular third-party libraries are started supporting coroutines e.g. Retrofit 2.6.0 now has <code>suspend</code> support.</p><p>Runtime permission is callback based API wherein you request for permission and listen for the result. Wouldnâ€™t it be awesome if you donâ€™t need to write boilerplate callback code for the result and consume it in a sequential way within coroutines? Well, this is exactly why I wrote this library focusing on clean and concise API that you can easily consume within coroutines (No callbacks yay ðŸŽ‰). We will see how in a bit.</p><p>Coming to LiveData support, Architecture Components has been around for quite some time. Observing runtime permission results through LiveData could be one of the interesting use-case. I thought it would be nice to have runtime permission API around LiveData. The library will expose LiveData of result and consumer can observe and decide what to do upon the result. We will see how in a bit.</p><h2 id=introduction-to-eazy-permissions>Introduction to Eazy Permissions<a hidden class=anchor aria-hidden=true href=#introduction-to-eazy-permissions>#</a></h2><p>Based on your need (coroutines support or LiveData support) you can include the library in your project as shown below.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=c1>//For coroutines
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>implementation</span> <span class=s1>&#39;com.sagar:coroutinespermission:1.0.0&#39;</span>
</span></span><span class=line><span class=cl><span class=c1>//For LiveData
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>implementation</span> <span class=s1>&#39;com.sagar:livedatapermission:1.0.0&#39;</span>
</span></span></code></pre></div><h3 id=coroutines-support>Coroutines support<a hidden class=anchor aria-hidden=true href=#coroutines-support>#</a></h3><p>Requesting permission is just a simple function call to suspending function <strong>requestPermissions</strong> of <a href=https://github.com/sagar-viradiya/eazypermissions/blob/master/coroutinespermission/src/main/java/com/eazypermissions/coroutinespermission/PermissionManager.kt><code>PermissionManager</code></a> from your coroutines or other suspending function which will return <a href=https://github.com/sagar-viradiya/eazypermissions/blob/master/common/src/main/java/com/eazypermissions/common/model/PermissionResult.kt><code>PermissionResult</code></a>. It takes 3 parameters.</p><ol><li>An instance of AppCompactActivity or Fragment depending on from where you are requesting permission.</li><li>Request id.</li><li>varargs of permission you want to request.</li></ol><p>Here is the signature of <code>requestPermissions</code> method.</p><script src="https://gist.github.com/sagar-viradiya/9ffea9ba6b14aaafa5595318a08709a9.js?file=CoroutinesPermissionManager.kt"></script><p>This is how you would request for permission within coroutines and get result sequentially.</p><script src="https://gist.github.com/sagar-viradiya/d01c20910e9d78fc2398c44d52772dd5.js?file=Fragment.kt"></script><p>You can request permission from coroutines launched using any dispatcher (IO/Default/Main).</p><p>Library exposes <a href=https://github.com/sagar-viradiya/eazypermissions/blob/master/common/src/main/java/com/eazypermissions/common/model/PermissionResult.kt><code>PermissionResult</code></a> as a result of permission request which is nothing but simple sealed class which wraps all possible outcomes.</p><script src="https://gist.github.com/sagar-viradiya/69928654f40774efdfeb4320b7bac5f1.js?file=PermissionResult.kt"></script><h3 id=livedata-support>LiveData support<a hidden class=anchor aria-hidden=true href=#livedata-support>#</a></h3><p>Just in case of coroutines we saw above requesting permission is just a simple method call to <a href=https://github.com/sagar-viradiya/eazypermissions/blob/master/livedatapermission/src/main/java/com/eazypermissions/livedatapermission/PermissionManager.kt><code>PermissionManager</code></a> from your Activity/Fragment. It takes 3 parameters.</p><ol><li>An instance of AppCompactActivity or Fragment depending from where you are requesting permission.</li><li>Request id.</li><li>varargs of permission you want to request.</li></ol><p>Here is the signature of <code>requestPermissions</code> method.</p><script src="https://gist.github.com/sagar-viradiya/1a9df6b97dc52ffbbe7ed18816a8fcb2.js?file=LiveDataPermissionManager.kt"></script><p>This is how you would request permissions from your Activity/Fragment.</p><script src="https://gist.github.com/sagar-viradiya/b83b2f02d65f20978b1df93b83a7882f.js?file=Fragment.kt"></script><h4 id=observing-result>Observing result<a hidden class=anchor aria-hidden=true href=#observing-result>#</a></h4><p>With just one simple step (implementing an interface) you are ready to observe the result of the request. Your Activity/Fragment must implement <code>**setupObserver**</code> method of <a href=https://github.com/sagar-viradiya/eazypermissions/blob/a69d7d221e60f3d431b60fcc911aef69514ac04b/livedatapermission/src/main/java/com/eazypermissions/livedatapermission/PermissionManager.kt#L141><code>PermissionObserver</code></a> interface which exposes LiveData&lt;<a href=https://github.com/sagar-viradiya/eazypermissions/blob/master/common/src/main/java/com/eazypermissions/common/model/PermissionResult.kt><code>PermissionResult</code></a>>. Here is the definition of interface.</p><script src="https://gist.github.com/sagar-viradiya/d8c4b603f67506aa6250913185bd657b.js?file=PermissionObserver.kt"></script><p>The library will only call <code>setupObserver</code> method when you are requesting permission for the first time. All the successive call to requestPermissions method will use the same observer.</p><p>Just as you would observe other LiveData you can observe LiveData&lt;<a href=https://github.com/sagar-viradiya/eazypermissions/blob/master/common/src/main/java/com/eazypermissions/common/model/PermissionResult.kt><code>PermissionResult</code></a>> as shown below.</p><script src="https://gist.github.com/sagar-viradiya/ffe87f2013ac187f0d593e03f38b2a6d.js?file=PermissionObserver.kt"></script><p>Thatâ€™s it, thatâ€™s all I had to share with you folks about this library. I will be maintaining this library regularly and I am hoping for your suggestions and contributions to improve this library. Head over to the GitHub repo below for more details about library.</p><p><a href=https://github.com/sagar-viradiya/eazypermissions>Eazy permission</a></p><p>Do give it a shot and let me know your feedback in comments below or you can reach out to me on <a href=https://twitter.com/viradiya_sagar>Twitter</a>.</p><p>Thatâ€™s it, for now, folks ðŸ™‚ Until next time ðŸ‘‹</p><p>Happy coding ðŸ˜ƒ</p><p><em>Thanks, <a href=https://medium.com/u/696aff678e4>Nate Ebel</a> and <a href=https://medium.com/u/8970f5acadd8>Nemi Shah</a> for proofreading this.</em></p><blockquote><p><em>This was originally posted on <a href=https://medium.com/proandroiddev/eazy-permissions-c574809bd682>Medium</a></em></p></blockquote></div><footer class=post-footer><ul class=post-tags><li><a href=https://sagarviradiya.dev/tags/runtime-permissions/>Runtime Permissions</a></li><li><a href=https://sagarviradiya.dev/tags/kotlin/>Kotlin</a></li><li><a href=https://sagarviradiya.dev/tags/kotlin-coroutines/>Kotlin Coroutines</a></li><li><a href=https://sagarviradiya.dev/tags/livedata/>LiveData</a></li><li><a href=https://sagarviradiya.dev/tags/android/>Android</a></li></ul><nav class=paginav><a class=prev href=https://sagarviradiya.dev/posts/kotlin-dsl-for-runtime-permissions/><span class=title>Â« Prev</span><br><span>Kotlin DSL for runtime permissions</span>
</a><a class=next href=https://sagarviradiya.dev/posts/sugar-koating-animation-api/><span class=title>Next Â»</span><br><span>Sugar koating Physics based Animation API</span></a></nav></footer><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//sagarviradiya-dev.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></article></main><footer class=footer><span>&copy; 2024 <a href=https://sagarviradiya.dev/>Sagar's Blog</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>